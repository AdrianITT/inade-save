{% extends 'accounts/base_dashboard.html' %}
{% load static %}
{% block title %}Términos y Avisos de Privacidad{% endblock %}
{% block header %}Términos y Avisos de Privacidad{% endblock %}
{% block content %}


<div class="container-xxl">

     <!-- SECCIÓN DE TÍTULO ENCABEZANDO -->
     <div class="row">
          <div class="col">
               <h1 class="text-center">Formatos de la organización</h1>
               <hr />
          </div>
     </div>
     
     <ul class="nav nav-tabs">
          <li class="nav-item">
               <a class="nav-link active" href="#organizacion" data-bs-toggle="tab">Organización</a>
          </li>
          <li class="nav-item">
               <a class="nav-link " href="#cotizaciones" data-bs-toggle="tab">Cotizaciones</a>
          </li>
          <li class="nav-item">
               <a class="nav-link" href="#ordenes" data-bs-toggle="tab">Órdenes de Trabajo</a>
          </li>
          <li class="nav-item">
               <a class="nav-link" href="#sistema" data-bs-toggle="tab">Configuracion del sistema</a>
          </li>
     </ul>

     <div class="tab-content">

          <div class="tab-pane fade show active" id="organizacion">

               <div class="row">
                    <div class="col">
                         <h2 class="mt-3">Organizacion</h2>
                    </div>
                    <div class="col mt-4 text-end">
                         <a href="{% url 'cargar_csd' %}" class="btn btn-primary">Carga Certificado de Sellos Dijitales</a>
                    </div>
                    
               </div>
               

               <!-- Spinner -->
               <div id="loading" style="display: none;" class="text-center">
                    <div class="spinner-border" role="status">
                         <span class="visually-hidden">Cargando...</span>
                    </div>
                    <p>Por favor, espera...</p>
               </div>

               <form method="post" enctype="multipart/form-data">  <!-- Añade enctype si usas archivos -->
                    {% csrf_token %}
                    

                    <div class="row">
                         <div class="col">
                              <!-- Campo para Nombre -->
                              <div class="form-group">
                                   {{ form.nombre.label_tag }}
                                   {{ form.nombre }}
                                   <small class="form-text text-muted">Ingrese el nombre de la organización.</small>
                              </div>

                              <!-- Campo para Slogan -->
                              <div class="form-group">
                                   {{ form.slogan.label_tag }}
                                   {{ form.slogan }}
                                   <small class="form-text text-muted">Ingrese el slogan de la organización.</small>
                              </div>
                               <!-- Campo para Régimen Fiscal -->
                              <div class="form-group">
                                   {{ form.regimen_fiscal.label_tag }}
                                   {{ form.regimen_fiscal }}
                                   <small class="form-text text-muted">Seleccione el régimen fiscal de la organización.</small>
                              </div>

                              <!-- Campo para Teléfono -->
                              <div class="form-group">
                                   {{ form.telefono.label_tag }}
                                   {{ form.telefono }}
                                   <small class="form-text text-muted">Ingrese el teléfono de contacto de la organización.</small>
                              </div>

                              <!-- Campo para Página Web -->
                              <div class="form-group">
                                   {{ form.pagina_web.label_tag }}
                                   {{ form.pagina_web }}
                                   <small class="form-text text-muted">Ingrese la URL de la página web de la organización.</small>
                              </div>

                              <!-- Campo para Logo -->
                              <div class="form-group">
                                   {{ form.logo.label_tag }}
                                   {{ form.logo }}
                                   <small class="form-text text-muted">Suba el logo de la organización en formato de imagen.</small>
                              </div>
                         </div>
                         <div class="col">
                              <!-- Campos de Dirección -->
                              <div class="form-group">
                                   {{ form.calle.label_tag }}
                                   {{ form.calle }}
                                   <small class="form-text text-muted">Ingrese la calle de la dirección de la organización.</small>
                              </div>

                              <div class="form-group">
                                   {{ form.numero.label_tag }}
                                   {{ form.numero }}
                                   <small class="form-text text-muted">Ingrese el número de la dirección de la organización.</small>
                              </div>

                              <div class="form-group">
                                   {{ form.colonia.label_tag }}
                                   {{ form.colonia }}
                                   <small class="form-text text-muted">Ingrese la colonia de la dirección de la organización.</small>
                              </div>

                              <div class="form-group">
                                   {{ form.ciudad.label_tag }}
                                   {{ form.ciudad }}
                                   <small class="form-text text-muted">Ingrese la ciudad de la dirección de la organización.</small>
                              </div>

                              <div class="form-group">
                                   {{ form.codigo.label_tag }}
                                   {{ form.codigo }}
                                   <small class="form-text text-muted">Ingrese el código postal de la dirección de la organización.</small>
                              </div>

                              <div class="form-group">
                                   {{ form.estado.label_tag }}
                                   {{ form.estado }}
                                   <small class="form-text text-muted">Ingrese el estado de la dirección de la organización.</small>
                              </div>
                         </div>
                    </div>

               

                    <div class="text-end m-5">
                        <button type="submit" name="guardar_organizacion" class="btn btn-success">Guardar configuración</button>
                    </div>
                </form>
          </div>

          <div class="tab-pane fade show" id="cotizaciones">
               <h2 class="mt-3">Cotizaciones</h2>
               <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="row">
                         <div class="col-md-4">
                              {% if formato_cotizacion.imagen_marca_agua %}
                                   <h4>Marca de agua:</h4>
                                   <div style="border: 1px solid #ddd; padding: 10px; margin-bottom: 15px;">
                                        <img src="{{ formato_cotizacion.imagen_marca_agua.url }}" alt="Marca de agua"
                                             style="max-width: 100%; height: auto;">
                                   </div>
                              {% else %}
                                   <code>No se ha subido ninguna imagen de marca de agua.</code>
                              {% endif %}
                         </div>
                         <div class="col">
                              {{ formato_cotizacion_form.as_p }}
                         </div>
                    </div>
                    <div class="text-end m-5">
                         <button type="submit" name="guardar_cotizacion" class="btn btn-success">Guardar Cotización</button>
                         <!-- Ejemplo de botón -->
                         <a href="{% url 'cotizacion_prueba' %}" class="btn btn-primary">Generar Cotización de Prueba Formato Acutal</a>
                    </div>
               </form>
          </div>

          <div class="tab-pane fade" id="ordenes">
               <h2 class="mt-3">Órdenes de Trabajo</h2>
               <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="row">
                         <div class="col-md-4">
                              {% if formato_orden.imagen_marca_agua %}
                                   <h4>Marca de agua:</h4>
                                   <div style="border: 1px solid #ddd; padding: 10px; margin-bottom: 15px;">
                                        <img src="{{ formato_orden.imagen_marca_agua.url }}" alt="Marca de agua"
                                             style="max-width: 100%; height: auto;">
                                   </div>
                              {% else %}
                                   <code>No se ha subido ninguna imagen de marca de agua.</code>
                              {% endif %}
                         </div>
                         <div class="col">
                              {{ formato_orden_form.as_p }}
                         </div>
                    </div>
                    <div class="text-end m-5">
                         <button type="submit" name="guardar_orden" class="btn btn-success">Guardar Orden</button>
                    </div>
                    
               </form>
          </div>

          <div class="tab-pane fade" id="sistema">
               <h2 class="mt-3">Configuración del Sistema</h2>
               <form method="post" novalidate>
                    {% csrf_token %}
                    <div class="mb-3">
                         <label for="moneda_predeterminada" class="form-label">Moneda Predeterminada</label>
                         {{ forms.moneda_predeterminada }}
                    </div>
                    <div class="mb-3">
                         <label for="tasa_iva_default" class="form-label">Tasa de IVA Predeterminada</label>
                         {{ forms.tasa_iva_default }}
                    </div>
                    <div class="mb-3">
                         <label for="formato_numero_cotizacion" class="form-label">Formato de Número de Cotización</label>
                         {{ forms.formato_numero_cotizacion }}
                    </div>
                    <div class="text-end m-5">
                         <button type="submit" name="guardar_sistema" class="btn btn-success">Guardar configuracion de sistema</button>
                    </div>
               </form>
          </div>
     </div>
</div>

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
     const swalWithBootstrapButtons = Swal.mixin({
          customClass: {
               confirmButton: "btn btn-success",
               cancelButton: "btn btn-danger"
          },
     });
     swalWithBootstrapButtons.fire({
          title: "Estas seguro?",
          text: "No podras revertir los cambios!",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: '#3085d6',
          cancelButtonColor: '#d33',
          confirmButtonText: "Si, seguro!",
          cancelButtonText: "No, cancelar!",

     }).then((result) => {
          if (result.isConfirmed) {
          } else if (result.dismiss === Swal.DismissReason.cancel) {
               // Redirigir a la página de inicio cuando se cancela
               window.location.href = "{% url 'home' %}"; // Cambia esta URL por la de tu página de inicio
          }
     });
</script>
{% endblock %}
{% endblock %}